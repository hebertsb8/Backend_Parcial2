# Generated by Django 5.1.4 on 2025-10-28 13:30

from django.db import migrations
from django.core.management import call_command

def generate_initial_data(apps, schema_editor):
    """
    Llama al management command para generar los datos de demostraci√≥n.
    El script `generate_demo_sales` es idempotente (no duplicar√° datos
    si ya existen), por lo que es seguro ejecutarlo aqu√≠.
    """
    try:
        print("\n\n---\nüöÄ  Ejecutando migraci√≥n de datos: Poblando la base de datos con datos de demostraci√≥n...\n")
        call_command('generate_demo_sales')
        print("\n‚úÖ  Migraci√≥n de datos completada.\n---\n")
    except Exception as e:
        print(f"\n‚ùå ERROR durante la migraci√≥n de datos: {e}")
        # No lanzamos una excepci√≥n para no detener el proceso de migraci√≥n
        # si la generaci√≥n de datos falla por alguna raz√≥n.

class Migration(migrations.Migration):

    dependencies = [
        ('sales', '0004_paymentmethod_order_payment_method'),
        # Dependencias de otras apps para asegurar que sus tablas existan
        ('api', '0002_alter_profile_role'),
        ('products', '0001_initial'),
    ]

    operations = [
        migrations.RunPython(generate_initial_data, reverse_code=migrations.RunPython.noop),
    ]